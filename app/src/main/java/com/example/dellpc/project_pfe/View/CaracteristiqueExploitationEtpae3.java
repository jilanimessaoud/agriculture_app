
package com.example.dellpc.project_pfe.View;

import android.content.Intent;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.RadioButton;
import android.widget.RadioGroup;

import com.example.dellpc.project_pfe.Controleur.ConnectionDetector;
import com.example.dellpc.project_pfe.Controleur.ControleurOccupSol;
import com.example.dellpc.project_pfe.Json.DAOModificationJuson;

import com.example.dellpc.project_pfe.Model.Exploitation;
import com.example.dellpc.project_pfe.R;
import com.example.dellpc.project_pfe.dataBase.DAOSQlite;

public class CaracteristiqueExploitationEtpae3 extends AppCompatActivity {
    ImageButton imageButtonRetour ;
    RadioGroup radioGroupTypeIrrg,radioGroupSinitaire,radioGroupAngrais;
    RadioButton radioButtonPrive ,radioButtonPublic ,  radioButtonSinitaire ,radioButtonNotSint,radioButtonAngrais,radioButtonNotAngrais ;
    EditText editTextNbPruit ,editTextNbSondage ;
    Button buttonSave ;
    ControleurOccupSol controleurOccupSol;
    Bundle  bundle ;
    DAOSQlite DAOSQlite;
    ConnectionDetector connectionDetector ;
    boolean connectionInternet  ;
    Exploitation exploitation ;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.occupation_sol_etap2);
        imageButtonRetour  =(ImageButton)findViewById(R.id.imageButtonretourOcup2) ;
    inial();

    if  (bundle.getInt("modification")!=0)
    {
        if (connectionInternet)
        {
            DAOModificationJuson modificationJuson =new DAOModificationJuson(CaracteristiqueExploitationEtpae3.this,this);
            modificationJuson.getCarcteristiqueExpEtape2(editTextNbPruit,editTextNbSondage,bundle.getString("numeroExploiataion"),radioButtonPrive,radioButtonPublic,radioButtonAngrais,radioButtonNotAngrais,radioButtonSinitaire,radioButtonNotSint);

        }
        else
            {
                exploitation = DAOSQlite.getExploitation(bundle.getString("numeroExploiataion"));
                if (exploitation!=null)
                {
                  editTextNbPruit.setText(String.valueOf(exploitation.getNombrePuits()));
                  editTextNbSondage.setText(String.valueOf(exploitation.getNombresSondage()));

                }
            }

    }
        seView();
    }
    void inial()

    {
        DAOSQlite =new DAOSQlite(this) ;
        connectionDetector = new ConnectionDetector(this) ;
        connectionInternet =connectionDetector.isConnected() ;
        bundle =getIntent().getExtras();
        buttonSave =(Button)findViewById(R.id.buttonSaveOccup);
        imageButtonRetour  =(ImageButton)findViewById(R.id.imageButtonretourOcup2) ;
        radioGroupAngrais = (RadioGroup)findViewById(R.id.radioGroupeEngrais);
        radioGroupSinitaire= (RadioGroup)findViewById(R.id.radioGroupsintaire);
        radioGroupTypeIrrg= (RadioGroup)findViewById(R.id.radioGroupeirrig);
        radioButtonAngrais=(RadioButton)findViewById(R.id.engrais);
        radioButtonNotAngrais=(RadioButton)findViewById(R.id.notEngr);
        radioButtonSinitaire=(RadioButton)findViewById(R.id.sinitaire);
        radioButtonNotSint=(RadioButton)findViewById(R.id.notSinitaire);
        radioButtonPrive=(RadioButton)findViewById(R.id.radioButtonprive);
        radioButtonPublic=(RadioButton)findViewById(R.id.radioButtonpublic);
        editTextNbPruit=(EditText) findViewById(R.id.nbpuits);
        editTextNbSondage=(EditText) findViewById(R.id.nbSondage);
    }
    void checkRadio ()
    {
        if (exploitation.getSourceEau().equals("Priv√©"))
        {
            radioButtonPrive.setChecked(true);
        }
        else {radioButtonPublic.setChecked(true);}
        if (exploitation.getTypeEngrais().equals("Non"))
        {
            radioButtonNotAngrais.setChecked(true);
        }
        else {
            radioButtonAngrais.setChecked(true);
        }
        if (exploitation.getTypeSanitaire().equals(" Non"))
        {
            radioButtonNotSint.setChecked(true);
        }
        else {
            radioButtonSinitaire.setChecked(true);
        }
    }
    void seView()
    {
        controleurOccupSol = new ControleurOccupSol(this,
                editTextNbPruit,editTextNbSondage,radioButtonPrive,radioButtonPublic,radioButtonSinitaire,radioButtonNotSint,radioButtonAngrais,radioButtonNotAngrais,radioGroupTypeIrrg,radioGroupSinitaire,radioGroupAngrais,bundle,CaracteristiqueExploitationEtpae3.this,getSupportFragmentManager());
        imageButtonRetour.setOnClickListener(controleurOccupSol);
         buttonSave.setOnClickListener(controleurOccupSol);
    }
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.menusortie,menu);
        return true;
    }


    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        int id = item.getItemId();
        Intent intent ;
        if (id ==R.id.itmexit)

        {
             intent = new Intent(getApplicationContext(),ViewLogin.class) ;
            startActivity(intent);
        }

        return super.onOptionsItemSelected(item);
    }
}
